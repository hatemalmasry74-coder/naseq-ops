<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>منصة نَسَق – النظافة</title>

  <link rel="stylesheet" href="nasaq-theme.css">
  <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@300;400;700;800;900&display=swap" rel="stylesheet">

  <style>
    body{font-family:"Almarai",sans-serif}
    .cardx{background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:18px;box-shadow:0 12px 26px rgba(0,0,0,.08);padding:16px}
    .muted{color:#6b7280}
    .row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
    @media(max-width:900px){.row{grid-template-columns:1fr}}
    input,select,textarea{width:100%;padding:12px 12px;border-radius:14px;border:1px solid rgba(0,0,0,.14);font-family:inherit}
    textarea{min-height:90px;resize:vertical}
    .btnrow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{border:none;border-radius:14px;padding:10px 14px;font-weight:900;cursor:pointer}
    .btn-primary{background:var(--nasaq-primary,#b91c1c);color:#fff}
    .btn-outline{background:#fff;border:1px solid rgba(0,0,0,.14);color:#111827}
    .table{width:100%;border-collapse:collapse;margin-top:10px}
    .table th,.table td{border-bottom:1px solid rgba(0,0,0,.08);padding:10px;text-align:right;font-size:13px}

    /* ===== Unified Top Nav ===== */
    .nasaq-topnav{
      display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap;
      padding:14px; margin:14px auto;
      border-radius:18px; background: rgba(255,255,255,.92);
      border:1px solid rgba(0,0,0,.08);
      box-shadow: 0 10px 22px rgba(0,0,0,.08);
    }
    .nasaq-topnav .tab{
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 14px; border-radius:999px;
      border:1px solid rgba(0,0,0,.12);
      background:#fff; color:#111827; font-weight:900;
      text-decoration:none; transition:.15s ease;
    }
    .nasaq-topnav .tab:hover{transform:translateY(-1px)}
    .nasaq-topnav .tab-active{
      background: var(--nasaq-primary, #b91c1c);
      color:#fff;
      border-color: var(--nasaq-primary, #b91c1c);
    }
  </style>
</head>

<body>
<main class="container">

  <!-- NAV الموحد -->
  <div class="nasaq-topnav" id="topnav">
    <a href="index.html" class="tab" data-page="index.html">الرئيسية</a>
    <a href="visits.html" class="tab" data-page="visits.html">الزيارات</a>
    <a href="tasks.html" class="tab" data-page="tasks.html">المهام</a>
    <a href="cleaning.html" class="tab" data-page="cleaning.html">النظافة</a>
    <a href="sop.html" class="tab" data-page="sop.html">SOP</a>
    <a href="settings.html" class="tab" data-page="settings.html">الإعدادات</a>
    <a href="plans.html" class="tab" data-page="plans.html">الخطط</a>
  </div>

  <div class="cardx">
    <h1 style="margin:0;font-weight:900">سجل النظافة – MVP</h1>
    <div class="muted">تسجيل أعمال النظافة اليومية/الأسبوعية بشكل مبسط مع حفظ محلي.</div>
  </div>

  <div class="cardx" style="margin-top:14px">
    <h2 style="margin:0 0 10px;font-weight:900">تسجيل بند نظافة</h2>

    <div class="row">
      <div>
        <label class="muted">التاريخ</label>
        <input id="date" type="date">
      </div>
      <div>
        <label class="muted">البراند</label>
        <select id="brand">
          <option value="سدف">سدف</option>
          <option value="طوبى">طوبى</option>
          <option value="دبل بي">دبل بي</option>
          <option value="Flavor Town">Flavor Town</option>
        </select>
      </div>
      <div>
        <label class="muted">الموقع/المنطقة</label>
        <input id="area" placeholder="مثال: المطبخ / الحمامات / الصالة">
      </div>
    </div>

    <div class="row" style="margin-top:10px">
      <div>
        <label class="muted">نوع البند</label>
        <select id="kind">
          <option value="يومي">يومي</option>
          <option value="أسبوعي">أسبوعي</option>
          <option value="تعقيم">تعقيم</option>
          <option value="مكافحة حشرات">مكافحة حشرات</option>
        </select>
      </div>
      <div>
        <label class="muted">الحالة</label>
        <select id="status">
          <option value="منجز" selected>منجز</option>
          <option value="غير منجز">غير منجز</option>
          <option value="بحاجة متابعة">بحاجة متابعة</option>
        </select>
      </div>
      <div>
        <label class="muted">مسؤول التنفيذ</label>
        <input id="owner" placeholder="اسم المسؤول">
      </div>
    </div>

    <div style="margin-top:10px">
      <label class="muted">ملاحظات/إثبات</label>
      <textarea id="notes" placeholder="مثال: صور قبل/بعد – تم التعقيم – تم تنظيف الثلاجات..."></textarea>
    </div>

    <div class="btnrow">
      <button class="btn btn-primary" onclick="add()">حفظ</button>
      <button class="btn btn-outline" onclick="resetForm()">مسح</button>
      <button class="btn btn-outline" onclick="clearAll()">حذف الكل</button>
    </div>
  </div>

  <div class="cardx" style="margin-top:14px">
    <h2 style="margin:0 0 10px;font-weight:900">السجل</h2>
    <table class="table">
      <thead>
        <tr>
          <th>التاريخ</th>
          <th>البراند</th>
          <th>الموقع</th>
          <th>النوع</th>
          <th>الحالة</th>
          <th>المسؤول</th>
          <th>ملاحظات</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="rows">
        <tr><td colspan="8" class="muted">لا توجد بيانات بعد.</td></tr>
      </tbody>
    </table>
  </div>

</main>

<script>
  (function activateTab(){
    const file = (location.pathname.split("/").pop() || "index.html").toLowerCase();
    document.querySelectorAll("#topnav .tab").forEach(a=>{
      const p = (a.getAttribute("data-page")||"").toLowerCase();
      if(p === file) a.classList.add("tab-active");
    });
  })();

  const LS_KEY="cleaning_v1";

  function todayISO(){
    const d=new Date();
    const m=String(d.getMonth()+1).padStart(2,"0");
    const day=String(d.getDate()).padStart(2,"0");
    return `${d.getFullYear()}-${m}-${day}`;
  }
  document.getElementById("date").value=todayISO();

  function load(){ try{return JSON.parse(localStorage.getItem(LS_KEY)||"[]")}catch(e){return []} }
  function save(arr){ localStorage.setItem(LS_KEY, JSON.stringify(arr)); }

  function resetForm(){
    document.getElementById("area").value="";
    document.getElementById("owner").value="";
    document.getElementById("notes").value="";
    document.getElementById("status").value="منجز";
    document.getElementById("kind").value="يومي";
    document.getElementById("date").value=todayISO();
  }

  function add(){
    const area=(document.getElementById("area").value||"").trim();
    if(!area){ alert("اكتب الموقع/المنطقة"); return; }
    const item={
      id: crypto.randomUUID ? crypto.randomUUID() : String(Date.now()),
      date: document.getElementById("date").value || todayISO(),
      brand: document.getElementById("brand").value,
      area,
      kind: document.getElementById("kind").value,
      status: document.getElementById("status").value,
      owner: (document.getElementById("owner").value||"").trim() || "—",
      notes: (document.getElementById("notes").value||"").trim()
    };
    const arr=load(); arr.unshift(item); save(arr);
    render(); resetForm();
    alert("تم الحفظ ✅");
  }

  function removeItem(id){
    save(load().filter(x=>x.id!==id));
    render();
  }

  function clearAll(){
    if(!confirm("حذف كل السجل؟")) return;
    localStorage.removeItem(LS_KEY);
    render();
  }

  function render(){
    const arr=load();
    const rows=document.getElementById("rows");
    if(!arr.length){
      rows.innerHTML=`<tr><td colspan="8" class="muted">لا توجد بيانات بعد.</td></tr>`;
      return;
    }
    rows.innerHTML=arr.map(x=>`
      <tr>
        <td>${x.date||""}</td>
        <td>${x.brand||""}</td>
        <td>${x.area||""}</td>
        <td>${x.kind||""}</td>
        <td><b>${x.status||""}</b></td>
        <td>${x.owner||""}</td>
        <td>${(x.notes||"").replace(/</g,"&lt;")}</td>
        <td><button class="btn btn-outline" onclick="removeItem('${x.id}')">حذف</button></td>
      </tr>
    `).join("");
  }

  render();
</script>

</body>
</html>
